****
#### 今日面试题总结
你在开发中参与了哪些功能开发让你觉得比较有挑战性？
参与了整个学习中心的功能开发，其中有很多的学习辅助功能都比较有特色。视频播放的进度记录就是一个特色功能，网站课程是以录播视频为主，为了提高用户学习体验，提供了视频续播功能。功能本身并不复杂，只不过产品要求比较高：
* 首先续播时间误差控制在30s之内
* 而且要做到用户突然断开或切换设备后，可以继续上一次播放
为了实现这个功能，需要将用户的播放进度保存在服务端，用户突然断开或切换设备后，续播时间误差不能超过30s，那播放进度的记录频率就需要比较高，我们在前端每隔15秒就发起一次心跳请求，提交最新的播放进度，记录到服务端

**学习计划**：简单来说就是设置课程每周计划学习几节课
有了学习计划后，可以在课程页面展示用户计划的完成情况，当用户学习完成一个小节后，就会新增一条学习记录，当该课程的全部小节学习完毕后，该课程就从学习中进入已学完状态。
#### 查询学习计划进度
思路分析：
* 本周计划学习的每个课程的学习进度
* 本周计划学习的课程总的学习进度
对于本周计划学习每个课程的学习进度，需要先查询出每个课程的信息，以获取学习计划，查询条件限定为当前登录用户id和学习计划进行中，一个用户可能报名了多个课程即LearningLesson
![[168683903153624.png]]
但是返回给前端的数据中缺少课程名称和本周学习的小节数量两个字段，课程名courseName可以通过courseId调用课程微服务获取，weekSections本周学习小节数量需要我们查询learning_record统计得到
大致步骤：我们需要先去查询课表，获取用户课表lesson信息，在搜集courseId查询出对应的课程信息，还需要搜集课表信息的lessonId，统计learningrecord表本周已经学习的小节数量，还需要统计本周计划学习的课程总的学习进度（查询计划学习的课程的weekFreq字段进行累加操作，对已学完的小节记录做count即可）,最后将收集到的数据转换为VO格式,